var hnMd=(()=>{var l=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var T=(e,t)=>{for(var n in t)l(e,n,{get:t[n],enumerable:!0})},C=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of y(t))!b.call(e,r)&&r!==n&&l(e,r,{get:()=>t[r],enumerable:!(o=x(t,r))||o.enumerable});return e};var $=e=>C(l({},"__esModule",{value:!0}),e);var A={};T(A,{copyThread:()=>h,extractThread:()=>d});var s=(e,t)=>(t||document).querySelector(e),u=(e="")=>e.replace(/\s+/g," ").trim(),c=e=>String(e).padStart(2,"0"),m=e=>{if(!e)return"";let t=e.cloneNode(!0);return t.querySelectorAll("a[href]").forEach(n=>n.textContent=n.href),t.querySelectorAll("p, br, div").forEach(n=>n.insertAdjacentText("beforebegin"," ")),u(t.textContent??"")},p=e=>{let t=s(".age",e)?.getAttribute("title")?.trim();if(!t)return"unknown";let n=t.split(/\s+/)[0],o=new Date(n.endsWith("Z")?n:`${n}Z`);return Number.isNaN(o.getTime())?"unknown":`${o.getUTCFullYear()}-${c(o.getUTCMonth()+1)}-${c(o.getUTCDate())}T${c(o.getUTCHours())}:${c(o.getUTCMinutes())}Z`},N=e=>{let t=s(".fatitem",e);if(!t)return null;let n=u(s(".titleline a",t)?.textContent??""),o=m(s(".commtext",t)),r=s(".titleline a",t)?.href??"",a=s(".hnuser",t)?.textContent?.trim()??"unknown",i=u([n,o,r&&!r.includes("item?id=")?r:""].filter(Boolean).join(" \u2014 "));return i?{user:a,message:i,timestamp:p(t),indent:0}:null},k=e=>[...e.querySelectorAll("tr.athing.comtr")].map(t=>{let n=parseInt(s("td.ind img",t)?.getAttribute("width")??"0",10),o=Number.isNaN(n)?0:Math.max(Math.round(n/40),0),r=s(".hnuser",t)?.textContent?.trim()??"unknown",a=m(s(".commtext",t))||"[no text]";return{user:r,message:a,timestamp:p(t),indent:o}}),S=()=>{let e=[];return t=>{let n=t+1;if(!e.length)e.push(1);else if(n>e.length)for(;e.length<n;)e.push(1);else e.splice(n),e[e.length-1]+=1;return e.join(".")}},d=(e=document)=>{let t=N(e),n=t?1:0,o=k(e).map(i=>({...i,indent:i.indent+n})),r=[t,...o].filter(Boolean),a=S();return r.map(({indent:i,user:f,message:g,timestamp:w})=>`${"  ".repeat(i)}- [${a(i)}] ${f}: ${g} [${w}]`).join(`
`)},v=async(e,t=document,n=window)=>{if(n?.navigator?.clipboard?.writeText)return await n.navigator.clipboard.writeText(e),!0;let o=t.createElement("textarea");o.value=e,t.body.append(o),o.select();let r=t.execCommand?.("copy");return o.remove(),!!r},h=async(e=document,t=window)=>{let n=d(e),o=await v(n,e,t);return(t?.alert??console.warn)(o?"Hacker News thread copied to clipboard":"Failed to copy Hacker News thread"),n};typeof window<"u"&&(window.hnMd={extractThread:d,copyThread:h});return $(A);})();
